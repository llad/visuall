<!DOCTYPE html>
<html>
<head>
	<title>Bar</title>
	<script type="text/javascript" src="js/paper.js"></script>
	<script type="text/paperscript" canvas="canvas">
		var maxPercent = 100;
		var barWidth = 20;
		var margin = 50;
		var periods = 12;

		//Axis Setup
		var xaxis = new Path.Line([margin,0], [margin,maxPercent*2]);
		xaxis.strokeColor = 'gray';

		var yaxis = new Path.Line([margin,maxPercent], [(periods*barWidth)+margin,maxPercent]);
		yaxis.strokeColor = 'gray';

		function rnd_bmt() {
			var x = 0, y = 0, rds, c;

			do {
			x = Math.random()*2-1;

			y = Math.random()*2-1;
			rds = x*x + y*y;
			}
			while (rds == 0 || rds > 1)

			// Box-Muller Transform
			c = Math.sqrt(-2*Math.log(rds)/rds);

			return [x*c, y*c];
		}


		function randBar (fundCount,offset) {
			// Create a random bar for demo purposes
			var marginOff = margin + offset
			var barOpacity = 1/(1+fundCount);
			var nrand = rnd_bmt();
			var fofReturn = nrand[0]*maxPercent/10;
			var fofReturnLine = new Path.Line([marginOff,maxPercent-fofReturn],[marginOff+barWidth,maxPercent-fofReturn]);
			fofReturnLine.strokeColor = 'black';

			for (var i = fundCount; i >= 0; i--) {
				var pfreturn = rnd_bmt()[0]*maxPercent/8;
				var subbar = new Path.Rectangle([marginOff,maxPercent-pfreturn],[barWidth,pfreturn-fofReturn]);

				var size = Math.abs(pfreturn-fofReturn);

				subbar.fillColor = '#ff0000';
				subbar.strokeColor = '#ff0000';
				subbar.opacity = barOpacity;
			};

		}

		function buildSample (fundCount,periods) {
			for (var i = periods; i >= 0; i--) {
				randBar(fundCount,barWidth*(periods-i));
			};
		}

		buildSample(20,periods);

	</script>
</head>
<body>
	<canvas id="canvas" resize></canvas>
</body>
</html>